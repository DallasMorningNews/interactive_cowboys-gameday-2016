$(document).ready(function(){function t(t,e){if(isNaN(t)===!0||isNaN(e)===!0)return alert("Please enter a valid score for both teams"),!1;if(0===t.length||0===e.length)return alert("Please enter a score for both teams"),!1;var o={week:l,cowscore:t,oppscore:e,comment:"No comment"};$.post("http://apps.dallasnews.com/livewire/cowboys-picks-2016",o,function(){console.log("Success!"),r()}).fail(function(){console.log("Whoops, something bad happened!")}),$("#userForm").addClass("noShow"),$("#response").removeClass("noShow")}function e(t,e){t>e?($(".userScore").text(t+"-"+e),$(".userTeam").text("Cowboys")):e>t?($(".userScore").text(e+"-"+t),$(".userTeam").text(h[d])):t===e&&($(".userScore").text(t+"-"+e),$(".userResult").text("tie the "+h[d]))}function o(t,e){var o="http%3A%2F%2Finteractives.dallasnews.com%2F2016%2Fcowboys-gameday/week"+l+".html",a="My week "+l+" Cowboys prediction: Cowboys "+t+", "+h[d]+" "+e+". Make your pick now.";$("#faceShare").click(function(){FB.ui({method:"feed",name:"Cowboys Gameday: You make the call",link:storyURL,caption:"",picture:storyIMG,description:a})}),$("#twitterShare").click(function(){window.open("https://www.twitter.com/intent/tweet?&hashtags=&text="+a+"&via=dallasnews&url="+o+"&image="+storyIMG,"top=200, left=200,width=550,height=420")})}function a(t){var e,o,a,r=t.length,s=0,n=0,c=0,i=0;$.each(t,function(t,e){e.cowscore>e.oppscore?(s++,c+=e.cowscore-e.oppscore):e.oppscore>e.cowscore&&(n++,i+=e.oppscore-e.cowscore)}),e=s>=n?"Cowboys":h[d],o="Cowboys"===e?s/r*100:n/r*100,o=Math.round(10*o)/10,a="Cowboys"===e?Math.round(c/s*10)/10:Math.round(i/n*10)/10,$(".predictPercentage").text(o+"%"),$(".predictTeam").text(e),$(".predictPoints").text(a)}function r(){m=[],x=[],w="",f="",$("#chart").html(""),$.getJSON("http://apps.dallasnews.com/livewire/cowboys-picks-2016/get/"+l).done(function(t){var e=[];$.each(t,function(t,o){o.cowscore<60&&o.oppscore<60&&e.push(o)}),s(e),a(e)})}function s(t){t.forEach(function(t){var e=[];e.push(t.cowscore),e.push(t.oppscore),m.push(e)}),w=_.countBy(m);var e=_.sortBy(w).reverse();f=e[0],_.forOwn(w,function(t,e){var o=e.split(","),a=[];a.push(parseInt(o[0])),a.push(parseInt(o[1])),x.push(a)}),n(x)}function n(t){var e={top:10,right:10,bottom:50,left:50},o=$("#chart").width()-e.left-e.right,a=$("#chart").width()-e.top-e.bottom,r=(o-e.left-e.right)/2,s=d3.max(t,function(t){return t[0]}),n=d3.max(t,function(t){return t[1]}),i=0;i=s>n?s:n;var p=d3.scaleLinear().range([0,o]).domain([0,i]),l=d3.scaleLinear().range([a,0]).domain([0,i]),u=d3.axisBottom(p).ticks(10).tickSize(-a),m=d3.axisLeft(l).ticks(10*a/o).tickSize(-o),x=d3.select("#chart").append("svg").attr("width",o+e.left+e.right).attr("height",a+e.top+e.bottom).append("g").attr("transform","translate("+e.left+","+e.top+")");x.append("g").attr("class","x axis ").attr("id","axis--x").attr("transform","translate(0,"+a+")").call(u),x.append("g").attr("class","y axis").attr("id","axis--y").call(m);var y=d3.scaleLinear().range([5,20]).domain([1,f]);x.selectAll(".dot").data(t).enter().append("circle").attr("class","dot").attr("r",function(t){var e=w[t[0]+","+t[1]];return y(parseInt(e))}).attr("cx",function(t){return p(parseInt(t[0]))}).attr("cy",function(t){return l(parseInt(t[1]))}).attr("opacity",".5").attr("class",function(t){return t[0]>t[1]?"cowboys-color":"opp-"+h[d].toLowerCase()}).on("mouseenter",function(t){var o=w[t[0]+","+t[1]],a=d3.mouse(this)[0],s=d3.mouse(this)[1];c(a,s,r,e),d3.select(".cowTipScore").text(t[0]),d3.select(".oppTipScore").text(t[1]),d3.select(".oppTipName").text(h[d]),d3.select(".tipPredict").text(o)}).on("mouseleave",function(){d3.select("#tooltip").classed("noShow",!0)}),d3.selectAll("circle").each(function(t){var e=parseInt(d3.select(this).attr("r"));e<10&&this.parentElement.appendChild(this)}),x.append("line").attr("x1",a).attr("y1",0).attr("x2",0).attr("y2",a).attr("stroke-width",2).attr("class","diagonal").attr("stroke","#329ce8"),x.append("text").attr("text-anchor","middle").attr("x",o/2*-1).attr("y",-25).attr("transform","rotate(-90)").attr("class","team-name").text(h[d]+"’ score"),x.append("text").attr("text-anchor","middle").attr("y",o+30).attr("x",o/2).attr("class","team-name").text("Cowboys’ score")}function c(t,e,o,a){tooltipWidth=180,$(window).width()<=600&&(tooltipWidth=120),d3.select("#tooltip").classed("noShow",!1).style("left",function(e){var r=t<=o?t+a.left+20+"px":t+a.left-(tooltipWidth+20)+"px";return r}).style("top",e+"px")}var i=new Date,p=i.getFullYear();$(".copyright").text(p);var l,d,h=["Giants","Redskins","Bears","49ers","Bengals","Packers","Bye","Eagles","Browns","Steelers","Ravens","Redskins","Vikings","Giants","Buccaneers","Lions","Eagles","bye","Packers","Conference opponent","Super Bowl opponent"],u=$("#seasonWeek").text().slice(-2);isNaN(u)!==!0?l=parseInt(u):(u=$("#seasonWeek").text(),"Wildcard"===u?l=18:"Divisional Round"===u?l=19:"Conference Championship"===u?l=20:"Super Bowl"===u&&(l=21)),d=l-1;var w,f,m=[],x=[];$("#opponent").text(h[d]);var y,g;$("#submit").click(function(){y=$("#cowScore").val(),g=$("#oppScore").val(),t(y,g),e(y,g),o(y,g)}),r();var v=$("#chartBlock").width();$("#chartBlock").css("min-height",v)});
//# sourceMappingURL=scripts-bundle.js.map
